{% extends "admin/base_site.html" %}
{% load adminmedia admin_list i18n %}
{% load smartif %}

{% block extrastyle %}
    {{ block.super }}
    <link rel="stylesheet" type="text/css" href="{% admin_media_prefix %}css/changelists.css" />
    <link rel="stylesheet" href="/admin/pagetree/media/css/pagetree.css" media="screen" />
{% endblock %}

{% block bodyclass %}change-list{% endblock %}

{% if not is_popup %}{% block breadcrumbs %}<div class="breadcrumbs"><a href="../../">{% trans "Home" %}</a> &rsaquo; <a href="../">{{ app_label|capfirst }}</a> &rsaquo; {{ cl.opts.verbose_name_plural|capfirst }}</div>{% endblock %}{% endif %}

{% block coltype %}flex{% endblock %}

{% block title %}Site Hierarchy | {% trans "Django Admin" %}{% endblock %}

{% block content_title %}<h1>Site Hierarchy</h1>{% endblock %}

{% block content %}

<div id="content-main">
{% block object-tools %}
{% endblock %}
    {% if not cl.result_list.0 %}
        <ul></ul>
        <form id="id_create_tree_root" action="{% url create_tree_root %}" method="GET">
            <div class="submit-row">
                <input style="float: left" value="Create Root" class="default" name="_create_tree_root" type="submit">
            </div>
        </form>
   {% else %}
       {% with cl.result_list.0.hierarchy.get_root as root %}
    	<div class="module{% if cl.has_filters %} filtered{% endif %}" id="changelist">
    	   <br />
    		{% block result_list %}
    		   <ul>
    		   {% for s in root.get_descendents %}
    					<li class="menu">
    					   {% ifnotequal s.id section.id %}
    					      <a href="../section/{{s.id}}">{{s.label}}</a>
    					   {%else%}
    					      <b>{{s.label}}</b>
    					   {% endifnotequal %}
    
    						{% with s.get_children as has_children %}
    							{% if has_children %}<ul>{% endif %}
    							{% if not has_children and s.is_last_child %}</ul>{% endif %}
    						{% endwith %}
    					</li>
    			{% endfor %}
    			</ul>
    		{% endblock %}
    	</div>
    	{% endwith %}
    {% endif %}	
</div>
{% endblock %}
